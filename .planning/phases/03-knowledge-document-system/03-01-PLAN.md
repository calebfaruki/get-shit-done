---
phase: 03-knowledge-document-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/knowledge/project-domain.md
  - get-shit-done/knowledge/planning-domain.md
autonomous: true
requirements: [KNOW-02, KNOW-03, KNOW-06]

must_haves:
  truths:
    - "Project domain doc exists with intake patterns, scope validation heuristics, and acceptance criteria sharpening guidance"
    - "Planning domain doc exists with phase planning standards and single-commit scope constraints"
    - "Both docs are under 10,000 tokens each"
    - "Both docs include explicit tool guidance for native Claude Code tools"
  artifacts:
    - path: "get-shit-done/knowledge/project-domain.md"
      provides: "Project domain knowledge (intake, scope, acceptance criteria)"
      contains: "scope validation"
    - path: "get-shit-done/knowledge/planning-domain.md"
      provides: "Planning domain knowledge (phase planning, single-commit scope)"
      contains: "single-commit"
  key_links:
    - from: "get-shit-done/knowledge/project-domain.md"
      to: "questioning.md content"
      via: "extracted and adapted intake methodology"
      pattern: "thinking partner|sharpen"
    - from: "get-shit-done/knowledge/planning-domain.md"
      to: "SPEC.md philosophy"
      via: "single-commit scope constraints"
      pattern: "one commit|atomic unit"
---

<objective>
Create project domain and planning domain knowledge documents that agents reason over instead of rigid workflow scripts.

Purpose: Extract domain knowledge from existing workflow scripts, agent files, and SPEC.md into focused reference documents that agents load based on their role. These replace embedded knowledge in monolithic agent files.

Output: Two knowledge documents in `get-shit-done/knowledge/` — one for project domain, one for planning domain.
</objective>

<execution_context>
@/Users/calebfaruki/.claude/get-shit-done/workflows/execute-plan.md
@/Users/calebfaruki/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@SPEC.md
@get-shit-done/references/questioning.md
@get-shit-done/agents/gsd-planner.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create project domain knowledge document</name>
  <files>get-shit-done/knowledge/project-domain.md</files>
  <action>
Create `get-shit-done/knowledge/` directory and `project-domain.md`.

Extract and adapt content from three sources:
1. **questioning.md** (references/) — migrate the intake methodology nearly verbatim. The philosophy, how_to_question, question_types, context_checklist, decision_gate, and anti_patterns sections are already agent-oriented. Adapt for single-commit scope (questioning.md references "downstream phases" — reframe for single-commit workflow per SPEC.md).
2. **SPEC.md sections 2 and 4** — extract scope validation heuristics (greenfield/mechanical/brownfield verifiability framework), acceptance criteria patterns (from `/new-project` spec), and scope ownership model.
3. **Tool guidance** — add explicit section mapping project domain operations to native Claude Code tools. Per locked decision: "Knowledge docs MUST include explicit guidance on which native Claude Code tools to use."

Structure the document with these sections:
- Brief overview (~5 lines) stating purpose and when agents load this doc
- `<intake>` section: questioning methodology (from questioning.md), adapted for single-commit scope. Remove AskUserQuestion references (that's a GSD-specific tool). Keep philosophy, how-to-question, question types, context checklist, decision gate, anti-patterns.
- `<scope_validation>` section: verifiability heuristics from SPEC.md — greenfield, mechanical, brownfield categories. Include "can I read this diff and confidently say it's correct?" test. Include scope ownership (new-project performs initial gate, plan-checker performs secondary).
- `<acceptance_criteria>` section: patterns for sharpening criteria. Extract from SPEC.md `/new-project` flow: criteria come from conversation not templates, must be concrete enough to verify against, out-of-scope items become todos.
- `<tool_guidance>` section: native tool usage for project domain operations. Reading files: use Read tool. Searching codebase: use Glob/Grep. Writing PROJECT.md: use Write tool. Never use bash cat/grep/find.

Target: 300-400 lines (~2.5-3K tokens). Do NOT exceed 600 lines.

Do NOT include orchestration steps (e.g., "run planner agent, then executor"). Orchestration belongs in Phase 4 command handlers.
Do NOT duplicate planning domain content. Cross-reference if needed.
  </action>
  <verify>
1. File exists: `ls get-shit-done/knowledge/project-domain.md`
2. Has required sections: grep for `<intake>`, `<scope_validation>`, `<acceptance_criteria>`, `<tool_guidance>`
3. Token estimate: `wc -w get-shit-done/knowledge/project-domain.md` — should be under 7500 words (10K tokens)
4. No bash tool anti-patterns: grep for "cat " or "grep -" or "find ." should return 0 matches outside of "NEVER" guidance examples
5. No orchestration leaks: grep for "run.*agent" or "spawn" should return 0 matches
  </verify>
  <done>project-domain.md exists in knowledge/ with intake, scope validation, acceptance criteria, and tool guidance sections, all under 10K tokens</done>
</task>

<task type="auto">
  <name>Task 2: Create planning domain knowledge document</name>
  <files>get-shit-done/knowledge/planning-domain.md</files>
  <action>
Create `get-shit-done/knowledge/planning-domain.md`.

Extract and adapt content from three sources:
1. **SPEC.md** — single-commit scope philosophy ("A project is one commit's worth of work"), phase decomposition approach (projects are strategic, phases are tactical), planning artifact lifecycle (ephemeral, discarded after commit).
2. **gsd-planner.md** (agents/) — extract planning principles that are domain knowledge (not orchestration): goal-backward methodology (truths → artifacts → wiring → key links), context budget rules (50% target, quality degradation curve), task sizing (15-60 min Claude execution), TDD detection heuristic, vertical slices vs horizontal layers preference.
3. **Tool guidance** — native tool usage for planning operations.

Structure the document with these sections:
- Brief overview (~5 lines) stating purpose and when agents load this doc
- `<single_commit_scope>` section: one commit = one project philosophy from SPEC.md. Vocabulary mapping (project=single commit, phase=tactical subdivision). What changes from GSD: no ROADMAP.md/STATE.md lifecycle, no auto-advance, no cross-session resume.
- `<phase_decomposition>` section: how to break projects into phases. Strategic (project-level) vs tactical (phase-level). Phase goals are outcome-shaped not task-shaped. Vertical slices preferred over horizontal layers.
- `<goal_backward>` section: the verification methodology. State goal → derive observable truths (3-7, user perspective) → derive required artifacts (specific files) → derive required wiring (connections) → identify key links (critical break points). Include must_haves output format.
- `<context_budget>` section: quality degradation curve (0-30% peak, 30-50% good, 50-70% degrading, 70%+ poor). Target 50% for standard plans, 40% for TDD plans. 2-3 tasks per plan max. Task sizing: 15-60 min Claude execution time.
- `<tool_guidance>` section: native tools for planning operations. Read tool for loading context files. Write tool for creating PLAN.md. Glob for finding phase files. Grep for searching codebase patterns.

Target: 250-350 lines (~2-3K tokens). Do NOT exceed 500 lines.

Do NOT include process orchestration (step-by-step execution flow). That belongs in command handlers (Phase 4).
Do NOT duplicate TDD methodology — reference execution domain doc for TDD details. Include only the detection heuristic here.
  </action>
  <verify>
1. File exists: `ls get-shit-done/knowledge/planning-domain.md`
2. Has required sections: grep for `<single_commit_scope>`, `<phase_decomposition>`, `<goal_backward>`, `<context_budget>`, `<tool_guidance>`
3. Token estimate: `wc -w get-shit-done/knowledge/planning-domain.md` — should be under 7500 words (10K tokens)
4. Single-commit philosophy present: grep for "one commit" or "single commit" should match
5. No orchestration leaks: grep for "Step 1.*Step 2" or "run.*agent" should return 0 matches
  </verify>
  <done>planning-domain.md exists in knowledge/ with single-commit scope, phase decomposition, goal-backward methodology, context budget, and tool guidance sections, all under 10K tokens</done>
</task>

</tasks>

<verification>
- [ ] `ls get-shit-done/knowledge/project-domain.md get-shit-done/knowledge/planning-domain.md` — both files exist
- [ ] `wc -w get-shit-done/knowledge/*.md` — each file under 7500 words
- [ ] Both files have `<tool_guidance>` sections with explicit native tool references
- [ ] No bash anti-patterns outside of "NEVER do this" examples
- [ ] Content is knowledge (principles, patterns, standards), not orchestration (step-by-step process)
</verification>

<success_criteria>
- Project domain doc covers intake methodology, scope validation, and acceptance criteria sharpening
- Planning domain doc covers single-commit scope, goal-backward methodology, and context budgets
- Both docs include tool guidance sections
- Both docs are well under 10K tokens (target 2-4K each)
- No orchestration content leaked into knowledge docs
</success_criteria>

<output>
After completion, create `.planning/phases/03-knowledge-document-system/03-01-SUMMARY.md`
</output>
