---
phase: 03-knowledge-document-system
plan: 03
type: execute
wave: 2
depends_on: [03-01, 03-02]
files_modified:
  - get-shit-done/knowledge/AGENTS.md
autonomous: true
requirements: [KNOW-01, KNOW-06]

must_haves:
  truths:
    - "AGENTS.md root index exists at ~100 lines pointing to all four domain knowledge docs"
    - "AGENTS.md is under 10,000 tokens"
    - "Every domain doc is referenced with its purpose and primary consumers"
    - "AGENTS.md provides enough context for agents to know which doc to load for their role"
  artifacts:
    - path: "get-shit-done/knowledge/AGENTS.md"
      provides: "Root index for agent knowledge system"
      contains: "project-domain"
      min_lines: 50
  key_links:
    - from: "get-shit-done/knowledge/AGENTS.md"
      to: "get-shit-done/knowledge/project-domain.md"
      via: "reference entry with purpose"
      pattern: "project-domain"
    - from: "get-shit-done/knowledge/AGENTS.md"
      to: "get-shit-done/knowledge/planning-domain.md"
      via: "reference entry with purpose"
      pattern: "planning-domain"
    - from: "get-shit-done/knowledge/AGENTS.md"
      to: "get-shit-done/knowledge/execution-domain.md"
      via: "reference entry with purpose"
      pattern: "execution-domain"
    - from: "get-shit-done/knowledge/AGENTS.md"
      to: "get-shit-done/knowledge/verification-domain.md"
      via: "reference entry with purpose"
      pattern: "verification-domain"
---

<objective>
Create the AGENTS.md root index that ties together all four domain knowledge documents into a navigable system.

Purpose: AGENTS.md is the entry point for the knowledge document system. Agents (or command handlers in Phase 4) use it to determine which domain docs to load based on their role. It replaces the need for agents to carry embedded domain knowledge in their instruction files.

Output: AGENTS.md root index in `get-shit-done/knowledge/`.
</objective>

<execution_context>
@/Users/calebfaruki/.claude/get-shit-done/workflows/execute-plan.md
@/Users/calebfaruki/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-knowledge-document-system/03-01-SUMMARY.md
@.planning/phases/03-knowledge-document-system/03-02-SUMMARY.md
@get-shit-done/knowledge/project-domain.md
@get-shit-done/knowledge/planning-domain.md
@get-shit-done/knowledge/execution-domain.md
@get-shit-done/knowledge/verification-domain.md
@SPEC.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AGENTS.md root index</name>
  <files>get-shit-done/knowledge/AGENTS.md</files>
  <action>
Create `get-shit-done/knowledge/AGENTS.md` as the root index for the knowledge document system.

Read all four domain docs created by plans 01 and 02 to understand their actual content (sections, scope, token size). Then create the index.

Structure:
1. **Header** (~5 lines): What this file is, how to use it. "This is the root index for agent knowledge documents. Agents load domain-specific docs based on their role. Command handlers (Phase 4) will reference this to determine which docs to pass to agents."

2. **Knowledge domains table**: Map each domain to its file path, purpose, primary sections, and estimated token size. Include all four:
   - Project domain → intake, scope validation, acceptance criteria
   - Planning domain → single-commit scope, phase decomposition, goal-backward, context budget
   - Execution domain → TDD flow, deviation rules
   - Verification domain → verification methodology, stub detection, staging rules

3. **Agent-to-domain mapping table**: Map agent roles to which domain docs they need. Based on existing agent specializations:
   - Project researcher → project-domain.md
   - Planner → planning-domain.md, project-domain.md (for scope context)
   - Plan checker → planning-domain.md
   - Executor → execution-domain.md
   - Verifier → verification-domain.md
   - Codebase mapper → (none — maps are mechanical, no domain knowledge needed)
   - Debugger → execution-domain.md (for deviation context)

4. **Shared principles** (~10-15 lines): Cross-cutting principles that apply to ALL agents regardless of domain:
   - Use native Claude Code tools (Read, Write, Glob, Grep, Edit, Bash) — never gsd-tools.cjs
   - One commit = one project (single-commit scope is the atomic unit)
   - Knowledge docs contain principles and patterns, not orchestration steps
   - Orchestration lives in command handlers, not knowledge docs

5. **Cross-references**: Note that domain docs may reference each other (e.g., planning references execution for TDD detection). Note that existing reference files (model-profiles.md, phase-argument-parsing.md) remain in `references/` as data tables, not knowledge documents.

Target: 80-120 lines (~800-1000 tokens). This is a navigation aid, not a knowledge document itself.

Do NOT duplicate content from domain docs. Brief descriptions only.
Do NOT include command-to-agent routing (that's Phase 4 command handler logic).
  </action>
  <verify>
1. File exists: `ls get-shit-done/knowledge/AGENTS.md`
2. Line count: `wc -l get-shit-done/knowledge/AGENTS.md` — should be 60-150 lines
3. References all four domains: grep for "project-domain" "planning-domain" "execution-domain" "verification-domain" all match
4. Agent mapping present: grep for "Planner\|Executor\|Verifier" matches
5. Token estimate: `wc -w get-shit-done/knowledge/AGENTS.md` — should be under 1000 words
6. No duplicated domain content: file should be concise navigation, not knowledge
  </verify>
  <done>AGENTS.md exists at ~100 lines as a root index pointing to all four domain docs, with agent-to-domain mapping and shared principles</done>
</task>

<task type="auto">
  <name>Task 2: Validate all knowledge docs against 10K token limit</name>
  <files>get-shit-done/knowledge/AGENTS.md</files>
  <action>
Run token estimation on all five knowledge documents (AGENTS.md + 4 domain docs). Use word count as proxy: 750 words ~= 1K tokens, so 7500 words ~= 10K tokens.

For each file in `get-shit-done/knowledge/`:
1. Count words with `wc -w`
2. Count lines with `wc -l`
3. Verify under 7500 words (10K token proxy)

If any file exceeds 7500 words:
- Identify which sections are largest
- Trim examples, reduce verbosity, or split into sub-doc
- Re-verify after changes

Also verify structural consistency:
- Each domain doc has a `<tool_guidance>` section
- Each domain doc has a brief overview at the top
- AGENTS.md references correct file paths
- No broken cross-references between docs

Report results as verification output. If all pass, no changes needed to AGENTS.md (this task just validates and potentially adjusts).
  </action>
  <verify>
1. `wc -w get-shit-done/knowledge/*.md` — all files under 7500 words
2. `wc -l get-shit-done/knowledge/*.md` — AGENTS.md 60-150 lines, domain docs 250-650 lines each
3. All domain docs have tool_guidance sections
4. Complete knowledge system: 5 files total in knowledge/ directory
  </verify>
  <done>All 5 knowledge documents validated under 10K tokens each, structural consistency confirmed across the knowledge system</done>
</task>

</tasks>

<verification>
- [ ] `ls get-shit-done/knowledge/` shows 5 files: AGENTS.md, project-domain.md, planning-domain.md, execution-domain.md, verification-domain.md
- [ ] `wc -w get-shit-done/knowledge/*.md` — all files under 7500 words
- [ ] AGENTS.md references all four domain docs
- [ ] Agent-to-domain mapping covers all agent roles
- [ ] No content duplication between AGENTS.md and domain docs
</verification>

<success_criteria>
- AGENTS.md exists at ~100 lines as a pure navigation/routing index
- All four domain docs are referenced with purpose and primary consumers
- Agent-to-domain mapping is complete and accurate
- All 5 knowledge docs pass 10K token limit (KNOW-06)
- Knowledge document system is coherent: an agent can find the right doc for its role
</success_criteria>

<output>
After completion, create `.planning/phases/03-knowledge-document-system/03-03-SUMMARY.md`
</output>
