---
phase: 01-characterization-tests-and-safe-deletion
plan: 03
type: execute
wave: 1
depends_on: []
files_modified: [get-shit-done/bin/lib/commands.cjs]
autonomous: true
gap_closure: true
requirements: [STATE-04]

must_haves:
  truths:
    - "resolve-model command executes without TypeError"
    - "commit command executes without TypeError"
    - "All 90 existing tests still pass"
    - "All 9 characterization tests still pass"
  artifacts:
    - path: "get-shit-done/bin/lib/commands.cjs"
      provides: "Updated config loading using getDefaultConfig"
      contains: "getDefaultConfig"
  key_links:
    - from: "get-shit-done/bin/lib/commands.cjs"
      to: "get-shit-done/bin/lib/core.cjs"
      via: "getDefaultConfig() import and calls"
      pattern: "getDefaultConfig"
---

<objective>
Fix the incomplete config.json removal in commands.cjs that breaks resolve-model and commit commands.

Purpose: Close the verification gap for STATE-04 — commands.cjs still imports the removed `loadConfig` function from core.cjs instead of using `getDefaultConfig`, causing TypeErrors in two commands.
Output: commands.cjs updated to use getDefaultConfig(); resolve-model and commit commands functional.
</objective>

<execution_context>
@/Users/calebfaruki/.claude/get-shit-done/workflows/execute-plan.md
@/Users/calebfaruki/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-characterization-tests-and-safe-deletion/01-02-SUMMARY.md
@get-shit-done/bin/lib/commands.cjs
@get-shit-done/bin/lib/core.cjs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update commands.cjs to use getDefaultConfig instead of loadConfig</name>
  <files>get-shit-done/bin/lib/commands.cjs</files>
  <action>
    Three changes in commands.cjs:

    1. Line 7 (require statement): In the destructured import from './core.cjs', replace `loadConfig` with `getDefaultConfig`. The current line imports `{ safeReadFile, loadConfig, isGitIgnored, execGit, ... }` — change `loadConfig` to `getDefaultConfig`.

    2. Line 205 (cmdResolveModel function): Replace `const config = loadConfig(cwd);` with `const config = getDefaultConfig();`. The function no longer needs to read config from disk — it uses hardcoded defaults. Note: `getDefaultConfig()` takes no arguments (no `cwd` parameter).

    3. Line 226 (cmdCommit function): Replace `const config = loadConfig(cwd);` with `const config = getDefaultConfig();`. Same reasoning — hardcoded defaults, no arguments.

    Do NOT change any other lines. The rest of commands.cjs is correct.
  </action>
  <verify>
    Run these three commands and confirm all succeed:
    1. `node get-shit-done/bin/gsd-tools.cjs resolve-model gsd-planner` — should output a model name (e.g., "opus" or "inherit"), NOT a TypeError
    2. `npm test` — should pass 90/90 tests
    3. `node --test tests/deletion-safety.test.cjs` — should pass 9/9 tests
  </verify>
  <done>
    resolve-model and commit commands execute without TypeError. All 90 tests pass. All 9 characterization tests pass. No remaining references to loadConfig anywhere in commands.cjs.
  </done>
</task>

</tasks>

<verification>
1. `node get-shit-done/bin/gsd-tools.cjs resolve-model gsd-planner` succeeds without TypeError
2. `npm test` passes 90/90
3. `node --test tests/deletion-safety.test.cjs` passes 9/9
4. `grep -c "loadConfig" get-shit-done/bin/lib/commands.cjs` returns 0 (no remaining references)
</verification>

<success_criteria>
- commands.cjs imports getDefaultConfig (not loadConfig) from core.cjs
- cmdResolveModel calls getDefaultConfig() instead of loadConfig(cwd)
- cmdCommit calls getDefaultConfig() instead of loadConfig(cwd)
- All tests pass, resolve-model and commit commands work
- STATE-04 requirement fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/01-characterization-tests-and-safe-deletion/01-03-SUMMARY.md`
</output>
